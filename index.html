<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Administrador de Cuentas Streaming - Tu App</title>
    <meta name="description"
        content="Sistema de gestión de cuentas de streaming para administrar clientes, ventas, finanzas y cuentas de plataformas como Netflix, HBO Max, etc." />
    <meta name="keywords"
        content="streaming, cuentas, gestión, clientes, ventas, finanzas, Netflix, HBO Max, Disney+, Spotify, administrador" />
    <meta name="author" content="Tu Nombre/Empresa" />
    <meta property="og:title" content="Administrador de Cuentas Streaming" />
    <meta property="og:description"
        content="Sistema de gestión de cuentas de streaming para administrar clientes, ventas, finanzas y cuentas de plataformas como Netflix, HBO Max, etc." />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://tudominio.com" />
    <!-- <meta property="og:image" content="https://tudominio.com/imagen-preview.jpg" /> -->

    <!-- Firebase Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.23.0/firebase-app-compat.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.23.0/firebase-firestore-compat.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.23.0/firebase-auth-compat.min.js"></script>

    <!-- Font Awesome para iconos profesionales -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
    <link rel="stylesheet" href="style.css" />
</head>

<body>
    <!-- Pantalla de Login (Admin) -->
    <div id="adminLoginScreen" class="login-screen" role="dialog" aria-modal="true" aria-labelledby="admin-login-title">
        <div class="login-container">
            <div class="login-card">
                <div class="login-header">
                    <div class="logo">
                        <i class="fas fa-user-shield" aria-hidden="true"></i>
                    </div>
                    <h1 id="admin-login-title">Admin Login</h1>
                    <p>Acceso al panel administrativo</p>
                </div>

                <div class="login-form">
                    <div class="form-group">
                        <label for="adminLoginEmail">
                            <i class="fas fa-envelope" aria-hidden="true"></i> Email
                        </label>
                        <input type="email" id="adminLoginEmail" class="form-control" placeholder="admin@tudominio.com"
                            autocomplete="username" aria-required="true" tabindex="0">
                    </div>

                    <div class="form-group" style="position: relative;">
                        <label for="adminLoginPassword">Contraseña</label>
                        <input type="password" id="adminLoginPassword" class="form-control" ...>
                        <i class="fas fa-eye" onclick="togglePasswordVisibility('adminLoginPassword')"
                            style="position: absolute; right: 15px; top: 70%; transform: translateY(-50%); cursor: pointer;"></i>
                    </div>

                    <button class="btn btn-full" onclick="loginAdmin()" tabindex="0">
                        <i class="fas fa-sign-in-alt" aria-hidden="true"></i>
                        Iniciar Sesión Admin
                    </button>
                    <button class="btn btn-secondary btn-full mt-3" onclick="showClientLogin()" tabindex="0">
                        <i class="fas fa-user" aria-hidden="true"></i>
                        Acceso Cliente
                    </button>

                    <div id="adminLoginError" class="login-error" style="display: none;" role="alert"
                        aria-live="assertive"></div>
                    <div id="adminLoginLoading" class="login-loading" style="display: none;" aria-live="polite">
                        <div class="spinner" role="status" aria-label="Cargando"></div>
                        <p>Verificando credenciales...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Pantalla de Login (Cliente) -->
    <div id="clientLoginScreen" class="login-screen client-login-screen" style="display: none;" role="dialog"
        aria-modal="true" aria-labelledby="client-login-title">
        <div class="login-container">
            <div class="login-card">
                <div class="login-header">
                    <div class="logo">
                        <i class="fas fa-user" aria-hidden="true"></i>
                    </div>
                    <h1 id="client-login-title">Acceso Cliente</h1>
                    <p>Ingresa a tu portal de cuentas</p>
                </div>

                <div class="login-form">
                    <div class="form-group">
                        <label for="clientLoginEmail">
                            <i class="fas fa-envelope" aria-hidden="true"></i> Email
                        </label>
                        <input type="email" id="clientLoginEmail" class="form-control" placeholder="tu@email.com"
                            autocomplete="username" aria-required="true" tabindex="0">
                    </div>

                    <div class="form-group" style="position: relative;">
                        <label for="clientLoginPassword">
                            <i class="fas fa-lock" aria-hidden="true"></i> Contraseña
                        </label>
                        <input type="password" id="clientLoginPassword" class="form-control" placeholder="Contraseña"
                            autocomplete="current-password" aria-required="true" tabindex="0">
                        <i class="fas fa-eye" onclick="togglePasswordVisibility('clientLoginPassword')"
                            style="position: absolute; right: 15px; top: 70%; transform: translateY(-50%); cursor: pointer; color: var(--secondary-color);"></i>
                    </div>

                    <button class="btn btn-full" onclick="loginClient()" tabindex="0">
                        <i class="fas fa-sign-in-alt" aria-hidden="true"></i>
                        Iniciar Sesión Cliente
                    </button>
                    <button class="btn btn-secondary btn-full mt-3" onclick="showClientRegister()" tabindex="0">
                        <i class="fas fa-user-plus" aria-hidden="true"></i>
                        Registrarse
                    </button>
                    <button class="btn btn-secondary btn-full mt-3" onclick="showAdminLogin()" tabindex="0">
                        <i class="fas fa-user-shield" aria-hidden="true"></i>
                        Acceso Admin
                    </button>

                    <div id="clientLoginError" class="login-error" style="display: none;" role="alert"
                        aria-live="assertive"></div>
                    <div id="clientLoginLoading" class="login-loading" style="display: none;" aria-live="polite">
                        <div class="spinner" role="status" aria-label="Cargando"></div>
                        <p>Verificando credenciales...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Pantalla de Registro (Cliente) -->
    <div id="clientRegisterScreen" class="login-screen client-login-screen" style="display: none;" role="dialog"
        aria-modal="true" aria-labelledby="client-register-title">
        <div class="login-container">
            <div class="login-card client-register-card">
                <div class="login-header">
                    <div class="logo">
                        <i class="fas fa-user-plus" aria-hidden="true"></i>
                    </div>
                    <h1 id="client-register-title">Registro de Cliente</h1>
                    <p>Crea tu cuenta para acceder a nuestros servicios</p>
                </div>

                <div class="login-form">
                    <div class="form-group">
                        <label for="registerName">
                            <i class="fas fa-user" aria-hidden="true"></i> Nombre <span aria-hidden="true">*</span>
                        </label>
                        <input type="text" id="registerName" class="form-control" placeholder="Tu nombre"
                            aria-required="true" tabindex="0">
                    </div>

                    <div class="form-group">
                        <label for="registerEmail">
                            <i class="fas fa-envelope" aria-hidden="true"></i> Email <span aria-hidden="true">*</span>
                        </label>
                        <input type="email" id="registerEmail" class="form-control" placeholder="tu@email.com"
                            aria-required="true" tabindex="0">
                    </div>

                    <div class="form-group">
                        <label for="registerPassword">
                            <i class="fas fa-lock" aria-hidden="true"></i> Contraseña <span aria-hidden="true">*</span>
                        </label>
                        <input type="password" id="registerPassword" class="form-control" placeholder="Contraseña"
                            aria-required="true" tabindex="0">
                    </div>

                    <div class="form-group">
                        <label for="registerConfirmPassword">
                            <i class="fas fa-lock" aria-hidden="true"></i> Confirmar Contraseña <span
                                aria-hidden="true">*</span>
                        </label>
                        <input type="password" id="registerConfirmPassword" class="form-control"
                            placeholder="Repite tu Contraseña" aria-required="true" tabindex="0">
                    </div>

                    <div class="form-group">
                        <label for="registerPhone">
                            <i class="fab fa-whatsapp" aria-hidden="true"></i> Teléfono (WhatsApp) <span
                                aria-hidden="true">*</span>
                        </label>
                        <input type="tel" id="registerPhone" class="form-control"
                            placeholder="Ej: 0912345678 o +593912345678" aria-required="true" tabindex="0">
                        <small class="form-text">Formato ecuatoriano (ej: 09XXXXXXXX o +593XXXXXXXXX)</small>
                    </div>

                    <button class="btn btn-full" onclick="registerClient()" tabindex="0">
                        <i class="fas fa-user-plus" aria-hidden="true"></i>
                        Registrarse
                    </button>
                    <button class="btn btn-secondary btn-full mt-3" onclick="showClientLogin()" tabindex="0">
                        <i class="fas fa-sign-in-alt" aria-hidden="true"></i>
                        Ya tengo cuenta
                    </button>

                    <div id="clientRegisterError" class="login-error" style="display: none;" role="alert"
                        aria-live="assertive"></div>
                    <div id="clientRegisterLoading" class="login-loading" style="display: none;" aria-live="polite">
                        <div class="spinner" role="status" aria-label="Cargando"></div>
                        <p>Registrando usuario...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Aplicación Principal (Admin) -->
    <div id="mainApp" class="main-app" style="display: none;">
        <!-- Header -->
        <header class="header" role="banner">
            <div class="header-content">
                <div class="header-brand">
                    <div class="logo">
                        <i class="fas fa-play-circle" aria-hidden="true"></i>
                    </div>
                    <h1>Streaming Admin</h1>
                </div>
                <div class="user-info">
                    <span id="userEmail" class="user-email" aria-label="Correo electrónico del usuario"></span>
                    <button class="btn btn-danger btn-sm" onclick="logoutAdmin()" aria-label="Cerrar sesión"
                        tabindex="0">
                        <i class="fas fa-sign-out-alt" aria-hidden="true"></i>
                        Salir
                    </button>
                </div>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="nav-tabs" role="navigation" aria-label="Navegación principal">
            <div class="nav-tabs-content">
                <button class="nav-btn active" onclick="showSection('dashboard')" aria-controls="dashboard"
                    aria-selected="true" role="tab" tabindex="0">
                    <i class="fas fa-chart-line" aria-hidden="true"></i> Dashboard
                </button>
                <button class="nav-btn" onclick="showSection('accounts')" aria-controls="accounts" aria-selected="false"
                    role="tab" tabindex="0">
                    <i class="fas fa-tv" aria-hidden="true"></i> Cuentas
                </button>
                <button class="nav-btn" onclick="showSection('clients')" aria-controls="clients" aria-selected="false"
                    role="tab" tabindex="0">
                    <i class="fas fa-users" aria-hidden="true"></i> Clientes Manuales
                </button>
                <button class="nav-btn" onclick="showSection('sales')" aria-controls="sales" aria-selected="false"
                    role="tab" tabindex="0">
                    <i class="fas fa-shopping-cart" aria-hidden="true"></i> Ventas
                </button>
                <button class="nav-btn" onclick="showSection('finances')" aria-controls="finances" aria-selected="false"
                    role="tab" tabindex="0">
                    <i class="fas fa-chart-pie" aria-hidden="true"></i> Finanzas
                </button>
                <button class="nav-btn" onclick="showSection('webClients')" aria-controls="webClients"
                    aria-selected="false" role="tab" tabindex="0">
                    <i class="fas fa-globe" aria-hidden="true"></i> Clientes Web
                    <span id="webClientsNotificationBadge" class="status-badge danger"
                        style="display: none; margin-left: 8px;"></span>
                </button>
                <button class="nav-btn" onclick="showSection('rechargeRequests')" aria-controls="rechargeRequests"
                    aria-selected="false" role="tab" tabindex="0">
                    <i class="fas fa-money-check-alt" aria-hidden="true"></i> Recargas
                    <span id="rechargeNotificationBadge" class="status-badge danger"
                        style="display: none; margin-left: 8px;"></span>
                </button>
                <button class="nav-btn" onclick="showSection('services')" aria-controls="services" aria-selected="false"
                    role="tab" tabindex="0">
                    <i class="fas fa-box" aria-hidden="true"></i> Servicios
                </button>
                <button class="nav-btn" onclick="showSection('config')" aria-controls="config" aria-selected="false"
                    role="tab" tabindex="0">
                    <i class="fas fa-cog" aria-hidden="true"></i> Config
                </button>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="main-content" role="main">
            <!-- Dashboard -->
            <section id="dashboard" class="section active" role="tabpanel" aria-labelledby="dashboard-tab">
                <div class="section-header">
                    <h2 class="section-title">
                        <i class="fas fa-chart-line" aria-hidden="true"></i>
                        Dashboard
                    </h2>
                </div>

                <div class="stats-grid">
                    <div class="stat-card" role="region" aria-labelledby="totalAccounts">
                        <div class="stat-header">
                            <div class="stat-icon">
                                <i class="fas fa-tv" aria-hidden="true"></i>
                            </div>
                        </div>
                        <div class="stat-number" id="totalAccounts">0</div>
                        <div class="stat-label">Cuentas Totales</div>
                    </div>
                    <div class="stat-card success" role="region" aria-labelledby="totalClients">
                        <div class="stat-header">
                            <div class="stat-icon">
                                <i class="fas fa-users" aria-hidden="true"></i>
                            </div>
                        </div>
                        <div class="stat-number" id="totalClients">0</div>
                        <div class="stat-label">Clientes Web</div>
                    </div>
                    <div class="stat-card warning" role="region" aria-labelledby="totalSales">
                        <div class="stat-header">
                            <div class="stat-icon">
                                <i class="fas fa-shopping-cart" aria-hidden="true"></i>
                            </div>
                        </div>
                        <div class="stat-number" id="totalSales">0</div>
                        <div class="stat-label">Ventas del Mes</div>
                    </div>
                    <div class="stat-card danger" role="region" aria-labelledby="totalRevenue">
                        <div class="stat-header">
                            <div class="stat-icon">
                                <i class="fas fa-dollar-sign" aria-hidden="true"></i>
                            </div>
                        </div>
                        <div class="stat-number" id="totalRevenue">$0</div>
                        <div class="stat-label">Ingresos</div>
                    </div>
                </div>

                <div class="cards-grid">
                    <div class="card" role="region" aria-labelledby="quick-actions-title">
                        <div class="card-header">
                            <h3 id="quick-actions-title"><i class="fas fa-bolt" aria-hidden="true"></i> Acciones Rápidas
                            </h3>
                        </div>
                        <div class="card-body">
                            <div class="action-buttons">
                                <button class="btn" onclick="openAddAccountModal()" tabindex="0">
                                    <i class="fas fa-plus" aria-hidden="true"></i> Nueva Cuenta
                                </button>
                                <button class="btn btn-success" onclick="openAddClientModal()" tabindex="0">
                                    <i class="fas fa-user-plus" aria-hidden="true"></i> Nuevo Cliente Manual
                                </button>
                                <button class="btn btn-warning" onclick="openSaleModal()" tabindex="0">
                                    <i class="fas fa-cash-register" aria-hidden="true"></i> Nueva Venta
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="card" role="region" aria-labelledby="platform-distribution-title">
                        <div class="card-header">
                            <h3 id="platform-distribution-title"><i class="fas fa-chart-bar" aria-hidden="true"></i>
                                Distribución por Plataforma</h3>
                        </div>
                        <div class="card-body">
                            <div id="platformStats">No hay cuentas registradas</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Cuentas -->
            <section id="accounts" class="section" role="tabpanel" aria-labelledby="accounts-tab" hidden>
                <div class="section-header">
                    <h2 class="section-title">
                        <i class="fas fa-tv" aria-hidden="true"></i>
                        Gestión de Cuentas
                    </h2>
                    <button class="btn" onclick="openAddAccountModal()" tabindex="0">
                        <i class="fas fa-plus" aria-hidden="true"></i> Nueva Cuenta
                    </button>
                </div>

                <div class="table-container">
                    <table class="table" id="accountsTable" role="table" aria-label="Tabla de Cuentas">
                        <thead>
                            <tr>
                                <th scope="col"><i class="fas fa-play-circle" aria-hidden="true"></i> Plataforma</th>
                                <th scope="col"><i class="fas fa-envelope" aria-hidden="true"></i> Usuario</th>
                                <th scope="col"><i class="fas fa-user-friends" aria-hidden="true"></i> Perfiles</th>
                                <th scope="col"><i class="fas fa-dollar-sign" aria-hidden="true"></i> Precio/Perfil</th>
                                <th scope="col"><i class="fas fa-credit-card" aria-hidden="true"></i> Precio Total</th>
                                <th scope="col"><i class="fas fa-info-circle" aria-hidden="true"></i> Estado</th>
                                <th scope="col"><i class="fas fa-tools" aria-hidden="true"></i> Acciones</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </section>

            <!-- Clientes Manuales -->
            <section id="clients" class="section" role="tabpanel" aria-labelledby="clients-tab" hidden>
                <div class="section-header">
                    <h2 class="section-title">
                        <i class="fas fa-users" aria-hidden="true"></i>
                        Gestión de Clientes Manuales
                    </h2>
                    <button class="btn btn-success" onclick="openAddClientModal()" tabindex="0">
                        <i class="fas fa-user-plus" aria-hidden="true"></i> Nuevo Cliente Manual
                    </button>
                </div>

                <div class="table-container">
                    <table class="table" id="clientsTable" role="table" aria-label="Tabla de Clientes">
                        <thead>
                            <tr>
                                <th scope="col"><i class="fas fa-user" aria-hidden="true"></i> Nombre</th>
                                <th scope="col"><i class="fab fa-whatsapp" aria-hidden="true"></i> WhatsApp</th>
                                <th scope="col"><i class="fas fa-envelope" aria-hidden="true"></i> Email</th>
                                <th scope="col"><i class="fas fa-shopping-cart" aria-hidden="true"></i> Compras</th>
                                <th scope="col"><i class="fas fa-calendar" aria-hidden="true"></i> ášltima Compra</th>
                                <th scope="col"><i class="fas fa-tools" aria-hidden="true"></i> Acciones</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </section>

            <!-- Ventas -->
            <section id="sales" class="section" role="tabpanel" aria-labelledby="sales-tab" hidden>
                <div class="section-header">
                    <h2 class="section-title">
                        <i class="fas fa-shopping-cart" aria-hidden="true"></i>
                        Gestión de Ventas
                    </h2>
                    <button class="btn btn-warning" onclick="openSaleModal()" tabindex="0">
                        <i class="fas fa-cash-register" aria-hidden="true"></i> Nueva Venta
                    </button>
                </div>

                <div class="table-container">
                    <table class="table" id="salesTable" role="table" aria-label="Tabla de Ventas">
                        <thead>
                            <tr>
                                <th scope="col"><i class="fas fa-user" aria-hidden="true"></i> Cliente</th>
                                <th scope="col"><i class="fas fa-play-circle" aria-hidden="true"></i> Plataforma</th>
                                <th scope="col"><i class="fas fa-user-friends" aria-hidden="true"></i> Perfiles</th>
                                <th scope="col"><i class="fas fa-calendar-alt" aria-hidden="true"></i> Inicio</th>
                                <th scope="col"><i class="fas fa-calendar-times" aria-hidden="true"></i> Fin</th>
                                <th scope="col"><i class="fas fa-dollar-sign" aria-hidden="true"></i> Total</th>
                                <th scope="col"><i class="fas fa-info-circle" aria-hidden="true"></i> Estado</th>
                                <th scope="col"><i class="fas fa-money-bill" aria-hidden="true"></i> Pago</th>
                                <th scope="col"><i class="fas fa-tools" aria-hidden="true"></i> Acciones</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </section>

            <!-- Finanzas -->
            <section id="finances" class="section" role="tabpanel" aria-labelledby="finances-tab" hidden>
                <div class="section-header">
                    <h2 class="section-title">
                        <i class="fas fa-chart-pie" aria-hidden="true"></i>
                        Centro Financiero
                    </h2>
                </div>

                <!-- Métricas principales -->
                <div class="stats-grid">
                    <div class="stat-card success" role="region" aria-labelledby="netProfit">
                        <div class="stat-header">
                            <div class="stat-icon">
                                <i class="fas fa-chart-line" aria-hidden="true"></i>
                            </div>
                        </div>
                        <div class="stat-number" id="netProfit">$0.00</div>
                        <div class="stat-label">Ganancia Neta</div>
                    </div>
                    <div class="stat-card danger" role="region" aria-labelledby="totalInvestment">
                        <div class="stat-header">
                            <div class="stat-icon">
                                <i class="fas fa-hand-holding-usd" aria-hidden="true"></i>
                            </div>
                        </div>
                        <div class="stat-number" id="totalInvestment">$0.00</div>
                        <div class="stat-label">Inversión Total</div>
                    </div>
                    <div class="stat-card" role="region" aria-labelledby="financialTotalRevenue">
                        <div class="stat-header">
                            <div class="stat-icon">
                                <i class="fas fa-money-bill-wave" aria-hidden="true"></i>
                            </div>
                        </div>
                        <div class="stat-number" id="financialTotalRevenue">$0.00</div>
                        <div class="stat-label">Ingresos Totales</div>
                    </div>
                    <div class="stat-card warning" role="region" aria-labelledby="averageROI">
                        <div class="stat-header">
                            <div class="stat-icon">
                                <i class="fas fa-percentage" aria-hidden="true"></i>
                            </div>
                        </div>
                        <div class="stat-number" id="averageROI">0%</div>
                        <div class="stat-label">ROI Promedio</div>
                    </div>
                </div>

                <!-- Tabs financieros -->
                <div class="finance-tabs" role="tablist" aria-label="Pestaá±as financieras">
                    <button class="tab-btn active" onclick="financialManager.showFinanceTab('overview', event)"
                        aria-controls="finance-overview" aria-selected="true" role="tab" tabindex="0">
                        <i class="fas fa-eye" aria-hidden="true"></i> Resumen
                    </button>
                    <button class="tab-btn" onclick="financialManager.showFinanceTab('accounts', event)"
                        aria-controls="finance-accounts" aria-selected="false" role="tab" tabindex="0">
                        <i class="fas fa-tv" aria-hidden="true"></i> Cuentas
                    </button>
                    <button class="tab-btn" onclick="financialManager.showFinanceTab('expenses', event)"
                        aria-controls="finance-expenses" aria-selected="false" role="tab" tabindex="0">
                        <i class="fas fa-receipt" aria-hidden="true"></i> Gastos
                    </button>
                    <button class="tab-btn" onclick="financialManager.showFinanceTab('reports', event)"
                        aria-controls="finance-reports" aria-selected="false" role="tab" tabindex="0">
                        <i class="fas fa-file-alt" aria-hidden="true"></i> Reportes
                    </button>
                </div>

                <!-- Tab: Resumen -->
                <div id="finance-overview" class="finance-tab-content active" role="tabpanel"
                    aria-labelledby="overview-tab">
                    <div class="cards-grid">
                        <div class="card" role="region" aria-labelledby="profitable-accounts-title">
                            <div class="card-header">
                                <h3 id="profitable-accounts-title"><i class="fas fa-trophy" aria-hidden="true"></i>
                                    Cuentas Más Rentables</h3>
                            </div>
                            <div class="card-body">
                                <div id="topProfitableAccounts">
                                    <div class="loading">Calculando...</div>
                                </div>
                            </div>
                        </div>

                        <div class="card" role="region" aria-labelledby="losing-accounts-title">
                            <div class="card-header">
                                <h3 id="losing-accounts-title"><i class="fas fa-exclamation-triangle"
                                        aria-hidden="true"></i> Cuentas con Pérdidas</h3>
                            </div>
                            <div class="card-body">
                                <div id="losingAccounts">
                                    <div class="loading">Calculando...</div>
                                </div>
                            </div>
                        </div>

                        <div class="card" role="region" aria-labelledby="upcoming-renewals-title">
                            <div class="card-header">
                                <h3 id="upcoming-renewals-title"><i class="fas fa-calendar-exclamation"
                                        aria-hidden="true"></i> Renovaciones Próximas</h3>
                            </div>
                            <div class="card-body">
                                <div id="upcomingRenewals">
                                    <div class="loading">Cargando...</div>
                                </div>
                            </div>
                        </div>

                        <div class="card" role="region" aria-labelledby="general-summary-title">
                            <div class="card-header">
                                <h3 id="general-summary-title"><i class="fas fa-chart-bar" aria-hidden="true"></i>
                                    Resumen General</h3>
                            </div>
                            <div class="card-body">
                                <div id="generalSummary">
                                    <div class="loading">Cargando...</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tab: Análisis por Cuentas -->
                <div id="finance-accounts" class="finance-tab-content" role="tabpanel" aria-labelledby="accounts-tab"
                    hidden>
                    <div class="table-container">
                        <table class="table" id="financialAccountsTable" role="table"
                            aria-label="Tabla de Análisis Financiero por Cuentas">
                            <thead>
                                <tr>
                                    <th scope="col"><i class="fas fa-play-circle" aria-hidden="true"></i> Plataforma
                                    </th>
                                    <th scope="col"><i class="fas fa-envelope" aria-hidden="true"></i> Email</th>
                                    <th scope="col"><i class="fas fa-dollar-sign" aria-hidden="true"></i> Costo</th>
                                    <th scope="col"><i class="fas fa-chart-line" aria-hidden="true"></i> Ingresos</th>
                                    <th scope="col"><i class="fas fa-hand-holding-usd" aria-hidden="true"></i> Ganancia
                                    </th>
                                    <th scope="col"><i class="fas fa-percentage" aria-hidden="true"></i> ROI</th>
                                    <th scope="col"><i class="fas fa-info-circle" aria-hidden="true"></i> Estado</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>

                <!-- Tab: Gestión de Gastos -->
                <div id="finance-expenses" class="finance-tab-content" role="tabpanel" aria-labelledby="expenses-tab"
                    hidden>
                    <div class="section-header">
                        <button class="btn btn-success" onclick="financialManager.openAddExpenseModal()" tabindex="0">
                            <i class="fas fa-plus" aria-hidden="true"></i> Agregar Gasto
                        </button>
                    </div>

                    <div class="stats-grid mb-3">
                        <div class="stat-card warning" role="region" aria-labelledby="monthlyExpenses">
                            <div class="stat-header">
                                <div class="stat-icon">
                                    <i class="fas fa-calendar-alt" aria-hidden="true"></i>
                                </div>
                            </div>
                            <div class="stat-number" id="monthlyExpenses">$0.00</div>
                            <div class="stat-label">Gastos del Mes</div>
                        </div>
                        <div class="stat-card danger" role="region" aria-labelledby="yearlyExpenses">
                            <div class="stat-header">
                                <div class="stat-icon">
                                    <i class="fas fa-calendar" aria-hidden="true"></i>
                                </div>
                            </div>
                            <div class="stat-number" id="yearlyExpenses">$0.00</div>
                            <div class="stat-label">Gastos del Aá±o</div>
                        </div>
                    </div>

                    <div class="table-container">
                        <table class="table" id="expensesTable" role="table" aria-label="Tabla de Gastos">
                            <thead>
                                <tr>
                                    <th scope="col"><i class="fas fa-calendar-alt" aria-hidden="true"></i> Fecha</th>
                                    <th scope="col"><i class="fas fa-file-text" aria-hidden="true"></i> Descripción</th>
                                    <th scope="col"><i class="fas fa-dollar-sign" aria-hidden="true"></i> Monto</th>
                                    <th scope="col"><i class="fas fa-tag" aria-hidden="true"></i> Categorá­a</th>
                                    <th scope="col"><i class="fas fa-tools" aria-hidden="true"></i> Acciones</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>

                <!-- Tab: Reportes -->
                <div id="finance-reports" class="finance-tab-content" role="tabpanel" aria-labelledby="reports-tab"
                    hidden>
                    <div class="cards-grid">
                        <div class="card report-card" onclick="financialManager.generateMonthlyReport()" role="button"
                            tabindex="0" aria-label="Generar Reporte Mensual">
                            <div class="card-header">
                                <h3><i class="fas fa-chart-bar" aria-hidden="true"></i> Reporte Mensual</h3>
                            </div>
                            <div class="card-body">
                                <p>Resumen de ingresos, gastos y rentabilidad del mes actual.</p>
                            </div>
                        </div>

                        <div class="card report-card" onclick="financialManager.generateAccountReport()" role="button"
                            tabindex="0" aria-label="Generar Reporte por Cuentas">
                            <div class="card-header">
                                <h3><i class="fas fa-chart-line" aria-hidden="true"></i> Reporte por Cuentas</h3>
                            </div>
                            <div class="card-body">
                                <p>Análisis detallado de rentabilidad por cuenta.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Clientes Web (Nueva Sección Admin) -->
            <section id="webClients" class="section" role="tabpanel" aria-labelledby="web-clients-tab" hidden>
                <div class="section-header">
                    <h2 class="section-title">
                        <i class="fas fa-globe" aria-hidden="true"></i>
                        Gestión de Clientes Web
                    </h2>
                </div>

                <div class="client-search-sort">
                    <input type="text" id="clientSearchInput" class="form-control"
                        placeholder="Buscar por nombre o email..." onkeyup="userManager.filterAndSortUsers()">
                    <select type="text" id="clientSortBy" class="form-control"
                        onchange="userManager.filterAndSortUsers()">
                        <option value="name">Ordenar por Nombre</option>
                        <option value="email">Ordenar por Email</option>
                        <option value="balance">Ordenar por Saldo</option>
                        <option value="createdAt">Ordenar por Fecha de Registro</option>
                    </select>
                    <select type="text" id="clientSortOrder" class="form-control"
                        onchange="userManager.filterAndSortUsers()">
                        <option value="asc">Ascendente</option>
                        <option value="desc">Descendente</option>
                    </select>
                </div>

                <div class="client-export-import">
                    <button class="btn btn-secondary" onclick="userManager.exportUsersToCsv()">
                        <i class="fas fa-file-csv" aria-hidden="true"></i> Exportar a CSV
                    </button>
                    <button class="btn btn-secondary" onclick="userManager.exportDatabaseToJson()">
                        <i class="fas fa-file-export" aria-hidden="true"></i> Exportar DB (JSON)
                    </button>
                    <input type="file" id="importJsonFile" accept=".json" style="display: none;"
                        onchange="userManager.importDatabaseFromJson(event)">
                    <button class="btn btn-secondary" onclick="document.getElementById('importJsonFile').click()">
                        <i class="fas fa-file-import" aria-hidden="true"></i> Importar DB (JSON)
                    </button>
                </div>

                <div class="table-container">
                    <table class="table" id="allClientsTable" role="table" aria-label="Tabla de Todos los Clientes">
                        <thead>
                            <tr>
                                <th scope="col"><i class="fas fa-user" aria-hidden="true"></i> Nombre</th>
                                <th scope="col"><i class="fas fa-envelope" aria-hidden="true"></i> Email</th>
                                <th scope="col"><i class="fas fa-dollar-sign" aria-hidden="true"></i> Saldo</th>
                                <th scope="col"><i class="fas fa-calendar-alt" aria-hidden="true"></i> Fecha Registro
                                </th>
                                <th scope="col"><i class="fas fa-tools" aria-hidden="true"></i> Acciones</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </section>

            <!-- Módulo de Verificación de Comprobantes de Pago (Admin) -->
            <section id="rechargeRequests" class="section" role="tabpanel" aria-labelledby="recharge-requests-tab"
                hidden>
                <div class="section-header">
                    <h2 class="section-title">
                        <i class="fas fa-money-check-alt" aria-hidden="true"></i>
                        Solicitudes de Recarga
                    </h2>
                </div>

                <div id="pendingRechargeRequests">
                    <div class="loading">Cargando solicitudes pendientes...</div>
                </div>

                <h3 class="section-title mt-3">
                    <i class="fas fa-history" aria-hidden="true"></i>
                    Historial de Recargas
                </h3>
                <div id="processedRechargeRequests">
                    <div class="loading">Cargando historial de recargas...</div>
                </div>
            </section>

            <section id="services" class="section" role="tabpanel" aria-labelledby="services-tab" hidden>
                <div class="section-header">
                    <h2 class="section-title">
                        <i class="fas fa-box" aria-hidden="true"></i>
                        Gestión de Servicios/Planes
                    </h2>
                    <button class="btn" onclick="openAddServiceModal()" tabindex="0">
                        <i class="fas fa-plus" aria-hidden="true"></i> Nuevo Servicio
                    </button>
                </div>

                <div class="table-container">
                    <table class="table" id="servicesTable" role="table" aria-label="Tabla de Servicios">
                        <thead>
                            <tr>
                                <th scope="col"><i class="fas fa-image" aria-hidden="true"></i> Imagen</th>
                                <th scope="col"><i class="fas fa-tag" aria-hidden="true"></i> Nombre</th>
                                <th scope="col"><i class="fas fa-dollar-sign" aria-hidden="true"></i> Precio</th>
                                <th scope="col"><i class="fas fa-info-circle" aria-hidden="true"></i> Descripción</th>
                                <th scope="col"><i class="fas fa-tv" aria-hidden="true"></i> Cuentas Disponibles</th>
                                <th scope="col"><i class="fas fa-tools" aria-hidden="true"></i> Acciones</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td colspan="6" class="no-data">No hay servicios registrados.</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Configuración -->
            <section id="config" class="section" role="tabpanel" aria-labelledby="config-tab" hidden>
                <div class="section-header">
                    <h2 class="section-title">
                        <i class="fas fa-cog" aria-hidden="true"></i>
                        Configuración
                    </h2>
                </div>

                <div class="card" role="region" aria-labelledby="firebase-status-title">
                    <div class="card-header">
                        <h3 id="firebase-status-title"><i class="fas fa-database" aria-hidden="true"></i> Estado de
                            Firebase</h3>
                    </div>
                    <div class="card-body">
                        <div id="configStatus">
                            <p id="configInfo"><strong>Estado:</strong> No conectado</p>
                        </div>
                        <button class="btn" onclick="testFirebaseConnection()" tabindex="0">
                            <i class="fas fa-plug" aria-hidden="true"></i> Probar Conexión
                        </button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Aplicación Principal (Cliente) -->
    <div id="clientApp" class="main-app" style="display: none;">
        <header class="client-portal-header" role="banner">
            <div class="header-brand">
                <div class="logo">
                    <i class="fas fa-user" aria-hidden="true"></i>
                </div>
                <h1>Mi Portal</h1>
            </div>
            <div class="user-info">
                <span id="clientDisplayName" class="user-email" aria-label="Nombre del cliente"></span>
                <span id="clientBalance" class="balance" aria-label="Saldo actual del cliente">$0.00</span>
                <button class="btn btn-danger btn-sm" onclick="logoutClient()" aria-label="Cerrar sesión" tabindex="0">
                    <i class="fas fa-sign-out-alt" aria-hidden="true"></i>
                    Salir
                </button>
            </div>
        </header>

        <main class="client-portal-content" role="main">
            <h2 class="client-section-title">
                <i class="fas fa-wallet" aria-hidden="true"></i>
                Mi Saldo y Transacciones
            </h2>
            <div class="cards-grid">
                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-dollar-sign" aria-hidden="true"></i> Saldo Actual</h3>
                    </div>
                    <div class="card-body text-center">
                        <p style="font-size: 2.5rem; font-weight: 700;" id="userCurrentBalance">$0.00</p>
                        <button class="btn btn-success mt-3" onclick="openRechargeModal()">
                            <i class="fas fa-plus-circle" aria-hidden="true"></i> Recargar Saldo
                        </button>
                    </div>
                </div>
                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-history" aria-hidden="true"></i> Historial de Transacciones</h3>
                    </div>
                    <div class="card-body">
                        <div id="transactionHistory">
                            <div class="no-data">No hay transacciones registradas.</div>
                        </div>
                    </div>
                </div>
            </div>

            <h2 class="client-section-title mt-3">
                <i class="fas fa-store" aria-hidden="true"></i>
                Catálogo de Cuentas
            </h2>

            <div class="catalog-filters"
                style="display:flex;gap:10px;flex-wrap:wrap;align-items:center;margin-bottom:1rem;">
                <div class="filter-group" style="position:relative;flex:1;min-width:200px;">
                    <i class="fas fa-search"
                        style="position:absolute;left:10px;top:50%;transform:translateY(-50%);color:#888;"></i>
                    <input id="searchCatalog" type="text" placeholder="Buscar servicio..."
                        oninput="applyCatalogFilters()"
                        style="width:100%;padding:8px 12px 8px 32px;border-radius:8px;border:1px solid #ddd;">
                </div>

                <div class="filter-group">
                    <select id="platformFilter" onchange="applyCatalogFilters()"
                        style="padding:8px 12px;border-radius:8px;border:1px solid #ddd;cursor:pointer;">
                        <option value="">Todas las plataformas</option>
                        <option value="Netflix">Netflix</option>
                        <option value="Spotify">Spotify</option>
                        <option value="Disney+">Disney+</option>
                        <option value="HBO Max">HBO Max</option>
                    </select>
                </div>

                <div class="filter-group">
                    <select id="priceSort" onchange="applyCatalogFilters()"
                        style="padding:8px 12px;border-radius:8px;border:1px solid #ddd;cursor:pointer;">
                        <option value="">Ordenar por precio</option>
                        <option value="asc">Menor a mayor</option>
                        <option value="desc">Mayor a menor</option>
                    </select>
                </div>
            </div>

            <div id="availableAccountsCatalog" class="cards-grid">
                <!-- Cuentas disponibles se renderizarán aquá­ -->
                <div class="loading">Cargando catálogo...</div>
            </div>

            <h2 class="client-section-title mt-3">
                <i class="fas fa-history" aria-hidden="true"></i>
                Mi Historial de Compras
            </h2>

            <div id="clientPurchaseHistory">
                <!-- Historial de compras se renderizará aquá­ -->
                <div class="no-data">No tienes compras registradas.</div>
            </div>
        </main>
    </div>

    <!-- Modal Overlay -->
    <div id="modal-overlay" class="modal-overlay" role="presentation"></div>

    <!-- Toast Notification Element -->
    <div id="toastNotification" class="toast-notification" role="alert" aria-live="assertive">
        <span id="toastIcon"></span>
        <span id="toastMessage"></span>
    </div>

    <!-- IMPORTANTE: Cargar config.js ANTES que script.js -->
    <script src="config.js"></script>
    <!-- Scripts al final del body -->
    <script src="script.js"></script>
</body>

</html>